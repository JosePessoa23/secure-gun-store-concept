@startuml

'-Style----------------------------------------------------------------------------------------------------------------

autonumber

skinparam DefaultTextAlignment center

skinparam BackgroundColor #fafdff

skinparam participant {
    BackgroundColor AWS_BG_COLOR
    BorderColor AWS_BORDER_COLOR
}

skinparam sequence {
    LifeLineBorderColor DodgerBlue
    LifeLineBackgroundColor APPLICATION

    ActorBackgroundColor APPLICATION
    ActorBorderColor DodgerBlue

    BackgroundColor #FFFFFF
    ArrowColor DodgerBlue
    BorderColor DodgerBlue
    ParticipantBorderColor DodgerBlue

    GroupBorderColor #082642
    GroupBackgroundColor APPLICATION
}

'-Title----------------------------------------------------------------------------------------------------------------

title US 07 - Use Shopping Cart

'-Actors/Participants--------------------------------------------------------------------------------------------------

actor "<b>Client" as A
participant "<b>:ShoppingCartRoute" as SR
participant "<b>:ShoppingCartController" as SC
participant "<b>:ShoppingCartMapper" as SM
participant "<b>:ShoppingCartService" as SS
participant "<b>shoppingCartDTO\n<b>:ShoppingCartDTO" as SD
participant "<b>:ShoppingCartRepository" as SRR
participant "<b>ShoppingCartSchema" as SSC

'-Associations---------------------------------------------------------------------------------------------------------

activate A

A -> SR: HTTP request (post)
activate SR

SR -> SC: addToCart(req, res, next)
activate SC

SC -> SM : mapWeaponToShoppingCart(weaponId)
activate SM
SM -> SD : create()
activate SD
SD --> SM : shoppingCartDTO
deactivate SD
SM --> SC : shoppingCartDTO
deactivate SM

SC -> SS : addToCart(shoppingCartDTO)
activate SS
SS -> SRR : getShoppingCart(userId)
activate SRR
SRR -> SSC : findOne({userId: userId})
activate SSC
SSC --> SRR : shoppingCart
deactivate SSC
SRR --> SS : shoppingCart
deactivate SRR

SS -> SRR : saveShoppingCart(shoppingCart)
activate SRR
SRR -> SSC : updateOne({_id: shoppingCart._id}, shoppingCart)
activate SSC
SSC --> SRR : updatedShoppingCart
deactivate SSC
SRR --> SS : updatedShoppingCart
deactivate SRR

SS --> SC : updatedShoppingCart
deactivate SS
SC --> SR: updatedShoppingCart
deactivate SC

SR --> A: Updated Shopping Cart
deactivate SR

'----------------------------------------------------------------------------------------------------------------------

@enduml
